<!-- SPDX-License-Identifier: Apache-2.0 -->

# Jmeter

-[Running JMeter Tests with Kubernetes Using JMeter Starter Kit](#running-jmeter-tests-with-kubernetes-using-jmeter-starter-kit)
-[Loading and Modifying the JMeter Test File:](#loading-and-modifying-the-jmeter-test-file)
-[Deploying and Running the JMeter Test:](#deploying-and-running-the-jmeter-test)
-[Conclusion:](#conclusion)

## Running JMeter Tests with Kubernetes Using JMeter Starter Kit

This document outlines the steps to effectively run JMeter tests on a Kubernetes environment using the JMeter Starter Kit. The kit simplifies the process of deploying JMeter instances on Kubernetes and facilitates running load tests. Below are the steps to load, modify, deploy, and manage JMeter tests within a Kubernetes cluster.

### Loading and Modifying the JMeter Test File:

1. **Launch JMeter GUI:**

    -Open the JMeter GUI to make test modifications conveniently.

2. **Load Test File:**

    -Use the JMeter GUI to load your test file. Navigate to "File" > "Open" and select the desired `.jmx` test file.

3. **Modify the Test:**

    -Make changes to the loaded test as needed using the GUI interface.

    -Save the test file after making modifications.

### Deploying and Running the JMeter Test:

1. **Open a Linux Shell:**

    -Open a Linux shell environment. If you're on Windows, you can use Git Bash for compatibility.

2. **Navigate to** `start_test.sh` **Folder:**

    -Use the terminal to navigate to the directory containing the `start_test.sh` script, e.g., `...jmeter-k8s-starterkit/start_test.sh`.

3. **Ensure Test Scenario Exists:**

    -Ensure that the scenario directory (e.g., `TP028`) is present within the `scenario` folder (`...jmeter-k8s-starterkit/scenario/`), and it contains the relevant `.jmx` test file.

    -Sample Test file:[KyleTP028.zip](/images/KyleTP028.zip)

4. **Run the Test:**

    -Execute the following command to run the test on the Kubernetes cluster:

```bash
./start_test.sh -n development -j KyleTP028.jmx -i 1 -r
```

-`-n development`: Specify the namespace for deployment.  
-`-j KyleTP028.jmx`: Specify the name of the JMeter `.jmx` file.  
-`-i 1`: Number of pods (instances) to deploy (optimal: 3 pods).  
-`-r`: Trigger the test run.  

Replace the values as appropriate for your test.

1. **Accessing Test Reports:**

    -After the test completes, you can access the reports generated by the master pod. Reports are usually located in the `/report` directory in the master pod's root.

    -To download a report, use the following command:

```bash
kubectl cp ${master_pod_name}:/report/${generated_report_folder} ./${destination_on_your_pc} -c jmmaster
```

-`${master_pod_name}`: Replace with the actual master pod's name.  
-`${generated_report_folder}`: Replace with the folder name containing the report.  
-`${destination_on_your_pc}`: Specify where you want to save the report on your local machine.

2. **Cleaning Up Report (Optional):**

    -Optionally, clean up the report folder on the master pod after downloading the reports to save space.

3. **Updating Spreadsheet:**

    -If the test results are significant, update the spreadsheet with the collected data.

    -Calculate the average error and transactions per second (TPS) for the test. Averaging data from four rows is recommended for accuracy.

### Conclusion:**

By following these steps, you can load, modify, deploy, and run JMeter tests on a Kubernetes cluster using the JMeter Starter Kit. This process streamlines the load testing process and allows you to effectively analyze application performance under different conditions. Remember to adapt the steps and commands based on your specific testing requirements and cluster setup.
